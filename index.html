<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>üå± –§–µ—Ä–º–∞ –º–µ—á—Ç—ã</title>
  <style>
    body {
      font-family: sans-serif;
      background: #d0f0c0;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 {
      margin-top: 20px;
    }
    #garden {
      margin: 20px auto;
      width: 90%;
      max-width: 600px;
      background: #7cfc00;
      border: 5px solid #4b8b3b;
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      padding: 10px;
      border-radius: 10px;
    }
    .garden-slot {
      height: 100px;
      background: #5cb85c;
      border: 2px solid #4b8b3b;
      border-radius: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 40px;
      cursor: pointer;
    }
    .garden-slot:hover {
      background: #4cae4c;
    }
    button {
      padding: 10px 20px;
      font-size: 18px;
      margin: 10px;
      cursor: pointer;
      background: #4b8b3b;
      color: white;
      border: none;
      border-radius: 5px;
    }
    button:hover {
      background: #3d7230;
    }
    #money, #inventory {
      font-size: 20px;
      margin: 10px;
    }
    #shop, #inventory-list {
      margin: 20px auto;
      width: 90%;
      max-width: 600px;
      background: #fff;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    #timer {
      font-size: 18px;
      margin-bottom: 10px;
    }
    #shop-items {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 10px;
    }
    .shop-item {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .out-of-stock {
      opacity: 0.5;
    }
  </style>
</head>
<body>
  <h1>üå± –§–µ—Ä–º–∞ –º–µ—á—Ç—ã</h1>
  <div id="money">üí∞ –î–µ–Ω—å–≥–∏: 100</div>
  
  <div id="garden">
  </div>
  
  <button onclick="plantSeed()">–ü–æ—Å–∞–¥–∏—Ç—å</button>

  <div id="shop">
    <h2>üõí –ú–∞–≥–∞–∑–∏–Ω</h2>
    <div id="timer">–î–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–∞–≥–∞–∑–∏–Ω–∞: 5:00</div>
    <div id="shop-items"></div>
  </div>

  <div id="inventory">
    <h2>üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
    <div id="inventory-list"></div>
    <button onclick="sellAllItems()">–ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë</button>
  </div>

  <script>
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å localStorage
    function saveGame() {
      const gameData = {
        money,
        gardenSlots,
        inventory,
        timer,
        shopItems,
        selectedItem,
        lastUpdate: Date.now()
      };
      localStorage.setItem('farmGameData', JSON.stringify(gameData));
    }

    function loadGame() {
      const savedData = localStorage.getItem('farmGameData');
      if (savedData) {
        const gameData = JSON.parse(savedData);
        money = gameData.money || 100;
        gardenSlots = gameData.gardenSlots || Array(10).fill(null);
        inventory = gameData.inventory || {};
        timer = gameData.timer || 300;
        shopItems = gameData.shopItems || [];
        selectedItem = gameData.selectedItem || null;
        
        // –ï—Å–ª–∏ –º–∞–≥–∞–∑–∏–Ω –ø—É—Å—Ç, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
        if (shopItems.length === 0) {
          refreshShop();
        }
      } else {
        // –ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –µ—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç
        money = 100;
        gardenSlots = Array(10).fill(null);
        inventory = {};
        timer = 300;
        refreshShop();
      }
    }

    let money;
    let gardenSlots;
    let shopItems;
    let inventory;
    const maxGardenSlots = 10;
    let timer;
    let selectedItem;

    const allItems = [
      // [–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ç–∏–ø, –º–∏–Ω —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏, –º–∞–∫—Å —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏, –º–∏–Ω —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏, –º–∞–∫—Å —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏, —à–∞–Ω—Å –ø–æ—è–≤–ª–µ–Ω–∏—è, –∏–∫–æ–Ω–∫–∞]
      ["–ü–æ–º–∏–¥–æ—Ä", "–æ–±—ã—á–Ω—ã–µ", 8, 30, 30, 68, 100, "üçÖ"],
      ["–Ø–±–ª–æ–∫–æ", "–æ–±—ã—á–Ω—ã–µ", 8, 30, 30, 68, 100, "üçé"],
      ["–ì–æ—Ä–æ—Ö", "–æ–±—ã—á–Ω—ã–µ", 8, 30, 38, 68, 100, "üå±"],
      ["–†–µ–¥–∏—Å", "–æ–±—ã—á–Ω—ã–µ", 8, 30, 35, 65, 100, "üå±"],
      ["–ú–æ—Ä–∫–æ–≤—å", "–Ω–µ–æ–±—ã—á–Ω—ã–µ", 225, 450, 255, 825, 80, "ü•ï"],
      ["–ë–∞–Ω–∞–Ω", "–Ω–µ–æ–±—ã—á–Ω—ã–µ", 225, 450, 285, 900, 77, "üçå"],
      ["–ú–∞–Ω–≥–æ", "–Ω–µ–æ–±—ã—á–Ω—ã–µ", 225, 450, 315, 975, 74, "ü•≠"],
      ["–ï–∂–µ–≤–∏–∫–∞", "–Ω–µ–æ–±—ã—á–Ω—ã–µ", 225, 450, 338, 1050, 72, "ü´ê"],
      ["–ö—É–∫—É—Ä—É–∑–∞", "–Ω–µ–æ–±—ã—á–Ω—ã–µ", 225, 450, 450, 1125, 70, "üåΩ"],
      ["–ö–∞–±–∞—á–æ–∫", "–Ω–µ–æ–±—ã—á–Ω—ã–µ", 225, 450, 400, 1100, 70, "ü•í"],
      ["–ì—Ä—É—à–∞", "—Ä–µ–¥–∫–∏–µ", 1500, 3750, 2250, 4500, 65, "üçê"],
      ["–ê—Ä–±—É–∑", "—Ä–µ–¥–∫–∏–µ", 1500, 3750, 2700, 5250, 65, "üçâ"],
      ["–ê–Ω–∞–Ω–∞—Å", "—Ä–µ–¥–∫–∏–µ", 1500, 3750, 3150, 6000, 65, "üçç"],
      ["–°–º–æ—Ä–æ–¥–∏–Ω–∞", "—Ä–µ–¥–∫–∏–µ", 1500, 3750, 3525, 6750, 65, "ü´ö"],
      ["–ö–ª—É–±–Ω–∏–∫–∞", "—Ä–µ–¥–∫–∏–µ", 1500, 3750, 3900, 7500, 65, "üçì"],
      ["–ê–ø–µ–ª—å—Å–∏–Ω", "—Å—É–ø–µ—Ä-—Ä–µ–¥–∫–∏–µ", 30000, 75000, 45000, 82500, 50, "üçä"],
      ["–õ–∏–º–æ–Ω", "—Å—É–ø–µ—Ä-—Ä–µ–¥–∫–∏–µ", 30000, 75000, 49500, 90000, 50, "üçã"],
      ["–í–∏–Ω–æ–≥—Ä–∞–¥", "—Å—É–ø–µ—Ä-—Ä–µ–¥–∫–∏–µ", 30000, 75000, 57000, 97500, 50, "üçá"],
      ["–ê–±—Ä–∏–∫–æ—Å", "—Å—É–ø–µ—Ä-—Ä–µ–¥–∫–∏–µ", 30000, 75000, 30000, 105000, 50, "üçë"],
      ["–ö–∏–≤–∏", "—Å—É–ø–µ—Ä-—Ä–µ–¥–∫–∏–µ", 30000, 75000, 35250, 112500, 50, "ü•ù"],
      ["–•—É—Ä–º–∞", "—Å—É–ø–µ—Ä-—Ä–µ–¥–∫–∏–µ", 30000, 75000, 42000, 120000, 50, "üçÖ"],
      ["–ü–µ—Ä—Å–∏–∫", "—Å—É–ø–µ—Ä-—Ä–µ–¥–∫–∏–µ", 30000, 75000, 45000, 127500, 50, "üçë"],
      ["–ü–∞–ø–∞–π—è", "—Å—É–ø–µ—Ä-—Ä–µ–¥–∫–∏–µ", 30000, 75000, 42000, 135000, 50, "ü•≠"],
      ["–î—ã–Ω—è", "—Å—É–ø–µ—Ä-—Ä–µ–¥–∫–∏–µ", 30000, 75000, 40500, 142500, 50, "üçà"],
      ["–ì—Ä–∞–Ω–∞—Ç", "—Å—É–ø–µ—Ä-—Ä–µ–¥–∫–∏–µ", 30000, 75000, 37500, 150000, 50, "üå∫"],
      ["–ë–∞–∫–ª–∞–∂–∞–Ω", "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ", 375000, 900000, 450000, 825000, 20, "üçÜ"],
      ["–ë—Ä–æ–∫–∫–æ–ª–∏", "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ", 375000, 900000, 465000, 900000, 20, "ü•¶"],
      ["–ö–∞–±–∞—á–æ–∫", "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ", 375000, 900000, 480000, 975000, 20, "ü•í"],
      ["–ö–∞–ø—É—Å—Ç–∞", "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ", 375000, 900000, 495000, 1050000, 20, "ü•¨"],
      ["–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å", "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ", 375000, 900000, 510000, 1125000, 20, "ü•î"],
      ["–¢—ã–∫–≤–∞", "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ", 375000, 900000, 540000, 1200000, 20, "üéÉ"],
      ["–û–≥—É—Ä–µ—Ü", "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ", 375000, 900000, 600000, 1275000, 20, "ü•í"],
      ["–ò–Ω–∂–∏—Ä", "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ", 375000, 900000, 450000, 1350000, 20, "üçà"],
      ["–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç", "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ", 375000, 900000, 435000, 1500000, 20, "üçä"],
      ["–î—Ä–∞–∫–æ–Ω–∏–π —Ñ—Ä—É–∫—Ç", "–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ", 1200000, 3000000, 1500000, 3000000, 10, "üêâ"],
      ["–ë–∞–º–±—É–∫", "–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ", 1200000, 3000000, 1950000, 3300000, 10, "üéç"],
      ["–ì—Ä–∏–±", "–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ", 1200000, 3000000, 2325000, 3600000, 10, "üçÑ"],
      ["–ù–µ–∫—Ç–∞—Ä–∏–Ω", "–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ", 1200000, 3000000, 2700000, 3825000, 10, "üçë"],
      ["–°–ª–∏–≤–∞", "–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ", 1200000, 3000000, 3000000, 4170000, 10, "üçë"],
      ["–õ—É–∫", "–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ", 1200000, 3000000, 1650000, 4500000, 10, "üßÖ"],
      
      ["–ö–∞–∫–∞–æ", "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–∏–µ", 6000000, 12000000, 7500000, 15000000, 4, "üç´"],
      ["–ü–µ—Ä–µ—Ü", "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–∏–µ", 6000000, 12000000, 9750000, 22500000, 4, "üå∂Ô∏è"],
      ["–®–ø–∏–Ω–∞—Ç", "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–∏–µ", 6000000, 12000000, 10500000, 30000000, 4, "ü•¨"],
      ["–ß–µ—Å–Ω–æ–∫", "–ø—Ä–∏–∑–º–∞—Ç–∏—á–µ—Å–∫–∏–µ", 6000000, 12000000, 12750000, 37500000, 4, "üßÑ"],
    ];

    function getRandomFromRange(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function refreshShop() {
      shopItems = [];
      allItems.forEach(item => {
        if (Math.random() * 100 < item[6]) {
          const quantity = getRandomFromRange(1, 10);
          shopItems.push({
            name: item[0],
            type: item[1],
            minBuy: item[2],
            maxBuy: item[3],
            minSell: item[4],
            maxSell: item[5],
            chance: item[6],
            icon: item[7],
            quantity: quantity
          });
        }
      });
      shopItems = shopItems.sort(() => 0.5 - Math.random()).slice(0, 10);
      renderShop();
      saveGame();
    }

    function renderShop() {
      const container = document.getElementById("shop-items");
      container.innerHTML = "";
      shopItems.forEach((item, index) => {
        const price = getRandomFromRange(item.minBuy, item.maxBuy);
        const div = document.createElement("div");
        div.className = item.quantity <= 0 ? "shop-item out-of-stock" : "shop-item";
        div.innerHTML = `
          ${item.icon} ${item.name} (${item.type}) ‚Äî ${price}üí∞ 
          <span>(${item.quantity} —à—Ç.)</span>
          ${item.quantity > 0 ? `<button onclick='selectItem(${index}, ${price})'>–í—ã–±—Ä–∞—Ç—å</button>` : '<span>–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</span>'}
        `;
        container.appendChild(div);
      });
    }

    function selectItem(index, price) {
      const item = shopItems[index];
      if (item.quantity <= 0) {
        alert("–≠—Ç–∏—Ö —Å–µ–º—è–Ω –±–æ–ª—å—à–µ –Ω–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏!");
        return;
      }
      
      selectedItem = { 
        name: item.name, 
        price, 
        icon: item.icon,
        shopIndex: index 
      };
      alert(`–í—ã–±—Ä–∞–Ω–æ —Ä–∞—Å—Ç–µ–Ω–∏–µ ${item.icon} ${item.name} –∑–∞ ${price}üí∞. –¢–µ–ø–µ—Ä—å –Ω–∞–∂–º–∏—Ç–µ "–ü–æ—Å–∞–¥–∏—Ç—å" –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–±–æ–¥–Ω—ã–π —Å–ª–æ—Ç.`);
      saveGame();
    }

    function plantSeed() {
      if (!selectedItem) {
        alert("–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ –≤ –º–∞–≥–∞–∑–∏–Ω–µ!");
        return;
      }
      
      if (money < selectedItem.price) {
        alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!");
        return;
      }
      
      const freeSlotIndex = gardenSlots.findIndex(slot => slot === null);
      
      if (freeSlotIndex === -1) {
        alert("–ù–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ –≤ —Å–∞–¥—É!");
        return;
      }
      
      // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–º—è–Ω –≤ –º–∞–≥–∞–∑–∏–Ω–µ
      shopItems[selectedItem.shopIndex].quantity--;
      
      money -= selectedItem.price;
      gardenSlots[freeSlotIndex] = {
        name: selectedItem.name,
        icon: selectedItem.icon
      };
      selectedItem = null;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞–≥–∞–∑–∏–Ω, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
      renderShop();
      updateUI();
      saveGame();
    }

    function harvest(slotIndex) {
      if (gardenSlots[slotIndex]) {
        const item = gardenSlots[slotIndex];
        const itemData = allItems.find(x => x[0] === item.name);
        const earnings = getRandomFromRange(itemData[4], itemData[5]);
        
        if (!inventory[item.name]) {
          inventory[item.name] = {
            count: 0,
            icon: item.icon
          };
        }
        
        inventory[item.name].count++;
        alert(`–í—ã —Å–æ–±—Ä–∞–ª–∏ ${item.icon} ${item.name} (–º–æ–∂–Ω–æ –ø—Ä–æ–¥–∞—Ç—å –∑–∞ ${earnings}üí∞)`);
        gardenSlots[slotIndex] = null;
        updateUI();
        saveGame();
      } else {
        alert("–≠—Ç–æ—Ç —Å–ª–æ—Ç –ø—É—Å—Ç!");
      }
    }

    function sellItem(name) {
      const itemData = allItems.find(x => x[0] === name);
      const price = getRandomFromRange(itemData[4], itemData[5]);
      money += price;
      inventory[name].count--;
      
      if (inventory[name].count <= 0) {
        delete inventory[name];
      }
      
      alert(`–í—ã –ø—Ä–æ–¥–∞–ª–∏ ${inventory[name]?.icon || ''} ${name} –∑–∞ ${price}üí∞`);
      updateUI();
      saveGame();
    }

    function sellAllItems() {
      let totalEarnings = 0;
      let soldItems = [];
      
      for (const name in inventory) {
        const itemData = allItems.find(x => x[0] === name);
        if (itemData) {
          const price = getRandomFromRange(itemData[4], itemData[5]);
          totalEarnings += price * inventory[name].count;
          soldItems.push(`${inventory[name].icon} ${name} (${inventory[name].count} —à—Ç.)`);
        }
      }
      
      if (soldItems.length > 0) {
        money += totalEarnings;
        inventory = {};
        alert(`–í—ã –ø—Ä–æ–¥–∞–ª–∏ –≤—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã:\n${soldItems.join("\n")}\n\n–ò—Ç–æ–≥–æ: ${totalEarnings}üí∞`);
        updateUI();
        saveGame();
      } else {
        alert("–í –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ –Ω–µ—Ç –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏!");
      }
    }

    function renderGarden() {
      const garden = document.getElementById("garden");
      garden.innerHTML = "";
      
      gardenSlots.forEach((slot, index) => {
        const slotElement = document.createElement("div");
        slotElement.className = "garden-slot";
        slotElement.innerHTML = slot ? `üåø ${slot.icon}` : "üå±";
        slotElement.onclick = () => harvest(index);
        garden.appendChild(slotElement);
      });
    }

    function updateUI() {
      document.getElementById("money").innerText = `üí∞ –î–µ–Ω—å–≥–∏: ${money}`;
      renderGarden();
      
      const inventoryList = document.getElementById("inventory-list");
      inventoryList.innerHTML = Object.keys(inventory).length 
        ? Object.keys(inventory).map(key => {
            const item = allItems.find(x => x[0] === key);
            const minSell = item[4];
            const maxSell = item[5];
            return `${inventory[key].icon} ${key}: ${inventory[key].count} (–ø—Ä–æ–¥–∞–∂–∞: ${minSell}-${maxSell}üí∞) <button onclick='sellItem("${key}")'>–ü—Ä–æ–¥–∞—Ç—å</button>`;
          }).join("<br>")
        : "–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç";
    }

    function updateTimer() {
      timer--;
      if (timer <= 0) {
        refreshShop();
        timer = 300;
      }
      const minutes = Math.floor(timer / 60);
      const seconds = timer % 60;
      document.getElementById("timer").innerText = `–î–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–∞–≥–∞–∑–∏–Ω–∞: ${minutes}:${seconds.toString().padStart(2, '0')}`;
      saveGame();
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
    loadGame();
    renderShop();
    setInterval(updateTimer, 1000);
    updateUI();

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä—É –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏
    window.addEventListener('beforeunload', saveGame);
  </script>
</body>
</html>
